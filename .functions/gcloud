#!/usr/bin/env bash

_gcp_pick_project() {
  local query="${1:-}"
  gcloud projects list \
    | _fzf_pick "${query}"
}

_gcp_change_project() {
  local query="${1:-}"

  local project
  project="$(_gcp_pick_project "${query}")"
  gcloud config set project "${project}"
  _info "Now using ${project}"
}

_gcp_compare_role() {
  local role1="${1:-}"
  local role2="${2:-}"
  icdiff \
    <(gcloud iam roles describe "${role1}") \
    <(gcloud iam roles describe "${role2}") \
    | less \
    || (
      _error "Failed to compare roles ${role1} and ${role2}"
      return 1
    )
}
